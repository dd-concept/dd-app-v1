import{r as x,j as e,C as J,P as le,u as K,a as A,b as ne,L as C,H as ie,S as de,c as ce,d as oe,e as M,f as Q,A as xe,g as F,E as me,h as I,i as ue,R as ge,X as W,N as pe,k as he,l as be,m as fe,n as ye,o as V,p as je,q as ve,s as Ne,J as v,T as we,M as ke,t as _e,v as Ce}from"./vendor-iuHqUh6p.js";import{c as f,u as G,h as z,s as _,i as Se,a as ze,g as $e,b as X,d as Ee,m as Te,e as Le,f as De,j as Pe,k as qe,l as Re,n as Ae,o as Me,p as Fe,v as Ie,q as Be,r as Ue}from"./main-BT7q5w7S.js";const Xe=le,He=x.forwardRef(({className:s,sideOffset:n=4,...d},t)=>e.jsx(J,{ref:t,sideOffset:n,className:f("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...d}));He.displayName=J.displayName;const Oe=()=>{const s=K(),n=A(),{itemCount:d}=G();ne();const t=r=>s.pathname===r,i=r=>l=>{l.preventDefault(),t(r)||(z(),_(),n(r),[50,100,200].forEach(c=>{setTimeout(_,c)}))};return e.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-50 bottom-nav-bar pb-4",children:e.jsxs("div",{className:"grid grid-cols-4 w-full max-w-md mx-auto h-28",children:[e.jsx(C,{to:"/",onClick:i("/"),className:f("flex items-start justify-center pt-4 transition-all duration-200",t("/")?"text-telegram-button active":"text-telegram-hint"),"aria-current":t("/")?"page":void 0,children:e.jsx(ie,{size:32})}),e.jsx(C,{to:"/shop",onClick:i("/shop"),className:f("flex items-start justify-center pt-4 transition-all duration-200",t("/shop")?"text-telegram-button active":"text-telegram-hint"),"aria-current":t("/shop")?"page":void 0,children:e.jsx(de,{size:32})}),e.jsx(C,{to:"/calculator",onClick:i("/calculator"),className:f("flex items-start justify-center pt-4 transition-all duration-200",t("/calculator")?"text-telegram-button active":"text-telegram-hint"),"aria-current":t("/calculator")?"page":void 0,children:e.jsx(ce,{size:32})}),e.jsx(C,{to:"/cart",onClick:i("/cart"),className:f("flex items-start justify-center pt-4 relative transition-all duration-200",t("/cart")?"text-telegram-button active":"text-telegram-hint"),"aria-current":t("/cart")?"page":void 0,children:e.jsxs("div",{className:"relative",children:[e.jsx(oe,{size:32}),d>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold w-6 h-6 flex items-center justify-center rounded-full badge",children:d})]})})]})})},Ye=({children:s,className:n,fullHeight:d=!1,hideNavigation:t=!1})=>{const[i,r]=x.useState("pt-4");return x.useEffect(()=>{const l=()=>{const a=Se(),g=ze(),p=$e();if(console.log("PageLayout padding calculation:",{isMobile:a,isInFullscreen:g,safeArea:p}),a){const u=(p==null?void 0:p.top)||44,N=20,j=u+N;console.log("Mobile padding calculation:",{topInset:u,basePadding:N,totalPadding:j}),j>=80?r("pt-24"):j>=64?r("pt-20"):j>=48?r("pt-16"):j>=32?r("pt-12"):r("pt-10")}else r("pt-4")};l();const c=setInterval(l,500),o=()=>{setTimeout(l,100)};return window.addEventListener("resize",o),window.addEventListener("orientationchange",o),()=>{clearInterval(c),window.removeEventListener("resize",o),window.removeEventListener("orientationchange",o)}},[]),e.jsxs("div",{className:f("w-full pb-52 max-w-md mx-auto",i,d?"min-h-screen":"",n),style:{backgroundColor:"transparent"},children:[e.jsx("div",{className:"animate-fade-in",children:s}),!t&&e.jsx(Oe,{})]})},Ve=({emoji:s,username:n,size:d="md",className:t,randomize:i=!1})=>{const[r,l]=x.useState(s||"ðŸ˜Š");x.useEffect(()=>{s?l(s):n?l(X(n,"avatar")):i&&l(Ee())},[s,n,i]);const c={sm:"w-8 h-8 text-lg",md:"w-12 h-12 text-2xl",lg:"w-16 h-16 text-3xl"};return e.jsx("div",{className:f("flex items-center justify-center rounded-full bg-telegram-light animate-pulse-slow",c[d],t),children:e.jsx("span",{className:"animate-float",children:r})})},Ze=({user:s,emoji:n,size:d="md",className:t=""})=>{const r={sm:"w-8 h-8",md:"w-12 h-12",lg:"w-16 h-16"}[d];return s!=null&&s.photo_url?e.jsx("div",{className:`${r} rounded-full overflow-hidden ${t}`,children:e.jsx("img",{src:s.photo_url,alt:`${s.first_name}'s profile`,className:"w-full h-full object-cover",onError:l=>{console.error("Error loading profile image, falling back to emoji avatar"),l.currentTarget.style.display="none"}})}):e.jsx(Ve,{emoji:n,size:d,className:t})},$=({size:s="md",className:n,fillColor:d,inline:t=!1})=>{const i="fill-telegram-blue",r={xs:"w-4 h-4",sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16",xl:"w-20 h-20"},l=e.jsxs("svg",{className:f("animate-spin",r[s],n),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:d||i,d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]});return t?l:e.jsx("div",{className:"flex justify-center items-center",children:l})},es=({banners:s,className:n="",autoPlayInterval:d=5e3})=>{const t=A(),i=r=>{r.link&&(r.external?window.open(r.link,"_blank","noopener,noreferrer"):(_(),t(r.link),[50,100,200].forEach(l=>{setTimeout(_,l)})))};return!s||s.length===0?null:e.jsxs("div",{className:`banner-swiper-container w-full relative ${n}`,children:[e.jsx(M,{modules:[Q,xe,F,me],spaceBetween:0,slidesPerView:1,pagination:{clickable:!0,type:"bullets",bulletClass:"swiper-pagination-bullet",bulletActiveClass:"swiper-pagination-bullet-active",el:".banner-pagination"},navigation:!1,autoplay:{delay:d,disableOnInteraction:!1},loop:s.length>1,effect:"slide",className:"w-full aspect-[2.5/1]",children:s.map((r,l)=>e.jsx(I,{className:"w-full h-full cursor-pointer",onClick:()=>i(r),children:e.jsx("div",{className:"w-full h-full bg-cover bg-center rounded-lg",style:{backgroundImage:`url(${r.image})`}})},l))}),e.jsx("div",{className:"banner-pagination flex justify-center mt-2"})]})},ss=()=>e.jsxs("a",{href:"https://t.me/dd_helper",target:"_blank",rel:"noopener noreferrer",className:"bg-cover bg-center rounded-lg p-4 shadow-sm hover-lift flex flex-col justify-between transform hover:-translate-y-1 hover:shadow-md transition-all duration-300",style:{backgroundImage:`url(${Te})`},children:[e.jsx("div",{children:e.jsx("h3",{className:"text-xl font-medium text-black/80",children:"DD MANAGER"})}),e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("p",{className:"text-xs text-black/50",children:"ÐŸÐ¾Ð¼Ð¾Ð¶ÐµÑ‚ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÑŒÑÑ Ñ Ñ†Ð²ÐµÑ‚Ð¾Ð¼ Ð¸ Ñ€Ð°Ð·Ð¼ÐµÑ€Ð¾Ð¼"})}),e.jsx("div",{className:"flex justify-end mt-1",children:e.jsx(ue,{size:20,className:"text-white"})})]}),Je=({previewImage:s,title:n,onClick:d,viewed:t=!1})=>{const i=n.split(`
`).map((r,l,c)=>e.jsxs(ge.Fragment,{children:[r,l<c.length-1&&e.jsx("br",{})]},l));return e.jsxs("div",{className:"flex flex-col items-center",onClick:d,children:[e.jsx("div",{className:`w-16 h-16 rounded-full overflow-hidden border-2 ${t?"border-gray-300":"border-telegram-blue"} cursor-pointer`,children:e.jsx("img",{src:s,alt:n,className:"w-full h-full object-cover"})}),e.jsx("div",{className:"text-xs text-center w-16 mt-1 leading-tight",children:i})]})},ts=({stories:s,onStoryClick:n,className:d=""})=>!s||s.length===0?null:e.jsx("div",{className:`w-full ${d}`,children:e.jsx("div",{className:"flex overflow-x-auto gap-5 no-scrollbar",children:s.map(t=>e.jsx(Je,{previewImage:t.previewImage,title:t.title,viewed:t.viewed,onClick:()=>n(t.id)},t.id))})}),Ke=`
  .image-swiper .swiper-pagination {
    bottom: 10px !important;
    position: absolute !important;
  }
  
  .image-swiper .swiper-pagination-bullet {
    width: 8px !important;
    height: 8px !important;
    background-color: rgba(255, 255, 255, 0.5) !important;
    opacity: 1 !important;
  }
  
  .image-swiper .swiper-pagination-bullet-active {
    background-color: #3b82f6 !important;
  }
`,as=({story:s,onClose:n})=>{const[d,t]=x.useState(0),i=x.useCallback(l=>{t(l.activeIndex)},[]),r=l=>c=>{c.preventDefault(),c.stopPropagation(),l()};return e.jsxs("div",{className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",children:[e.jsx("style",{children:Ke}),e.jsx("div",{className:"absolute inset-0",onClick:n}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-hidden",children:[e.jsx("button",{onClick:r(()=>{z(),n()}),className:"absolute top-4 right-4 z-20 text-gray-600 dark:text-gray-300 p-2 bg-white/80 dark:bg-gray-800/80 rounded-full hover:bg-white dark:hover:bg-gray-700 transition-colors",children:e.jsx(W,{size:20})}),e.jsx("div",{className:"absolute top-0 left-0 right-0 z-10 bg-gradient-to-b from-black/50 to-transparent p-4",children:e.jsx("h3",{className:"text-white font-semibold text-lg",children:s.title})}),e.jsx("div",{className:"relative aspect-[9/16] overflow-hidden",children:e.jsx(M,{modules:[Q,F],spaceBetween:0,slidesPerView:1,pagination:{clickable:!0,type:"bullets",bulletClass:"swiper-pagination-bullet",bulletActiveClass:"swiper-pagination-bullet-active"},onSlideChange:i,className:"w-full h-full image-swiper",touchRatio:1,threshold:10,longSwipesRatio:.5,longSwipesMs:300,children:s.images.map((l,c)=>e.jsx(I,{className:"w-full h-full",children:e.jsx("img",{src:l,alt:`${s.title} - ${c+1}`,className:"w-full h-full object-cover",draggable:!1})},c))})})]})]})},rs=({product:s,className:n})=>{const d=A(),t=X(`${s.item_name}-${s.color_code}`,"product"),i=Array.isArray(s.sizes)?Le(s.sizes.filter(o=>o.quantity>0).map(o=>o.size)):[],r=s.photos&&s.photos.length>0,l=()=>{if(!r)return"";const o=s.photos.find(a=>a.photo_category==="front"&&a.photo_url);return o?o.photo_url:s.photos[0].photo_url},c=o=>{o.preventDefault(),De("medium"),_(),d(`/product/${s.sku}`),[50,100,200].forEach(a=>{setTimeout(_,a)})};return e.jsxs(C,{to:`/product/${s.sku}`,onClick:c,className:f("block bg-telegram-secondary-bg rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-all duration-300 hover-lift",n),children:[e.jsx("div",{className:"aspect-square bg-telegram-bg flex items-center justify-center",children:r?e.jsx("img",{src:l(),alt:s.item_name,className:"w-full h-full object-cover",onError:o=>{o.currentTarget.style.display="none",o.currentTarget.parentElement.innerHTML=`<span class="text-5xl animate-float">${t}</span>`}}):e.jsx("span",{className:"text-5xl animate-float",children:t})}),e.jsxs("div",{className:"p-4 min-h-[120px] flex flex-col justify-between",children:[e.jsx("div",{className:"mb-2",children:e.jsx("div",{className:"mb-1",children:e.jsxs("h3",{className:"font-medium text-telegram-text break-words line-clamp-2",children:[s.brand," ",s.item_name]})})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"font-medium text-telegram-button",children:[typeof s.price_rub=="string"?parseFloat(s.price_rub).toLocaleString():s.price_rub.toLocaleString(),"â‚½"]}),s.color_hex&&e.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-300",style:{backgroundColor:s.color_hex}})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[i.slice(0,3).map(o=>e.jsx("span",{className:"text-xs px-2 py-1 bg-telegram-bg text-telegram-text rounded-full",children:o},o)),i.length>3&&e.jsxs("span",{className:"text-xs px-2 py-1 bg-telegram-bg text-telegram-text rounded-full",children:["+",i.length-3]})]})]})]})]})},ls=({availableSizes:s,selectedSize:n,onChange:d,className:t})=>{const i=r=>{d(r)};return e.jsx("div",{className:f("w-full",t),children:e.jsx("div",{className:"flex flex-wrap gap-2",children:s.map(r=>e.jsx("button",{className:f("px-4 py-2 rounded-full border transition-all duration-200",n===r?"border-telegram-button bg-telegram-button/10 text-telegram-button":"border-telegram-hint/30 bg-telegram-bg text-telegram-text hover:border-telegram-hint/50"),onClick:()=>i(r),children:r},r))})})},ns=({photos:s,productName:n,fallbackEmoji:d="ðŸ“¦",className:t=""})=>{const[i,r]=x.useState(0),l=c=>{const o=c.currentTarget;if(o.style.display="none",o.parentElement){const a=document.createElement("div");a.className="w-full h-full flex items-center justify-center",a.innerHTML=`<span class="text-8xl animate-float">${d}</span>`,o.parentElement.appendChild(a)}};return!s||s.length===0?e.jsx("div",{className:`w-full aspect-square bg-telegram-bg flex items-center justify-center ${t}`,children:e.jsx("span",{className:"text-8xl animate-float",children:d})}):e.jsxs("div",{className:`photo-swiper-container w-full aspect-square bg-telegram-bg relative ${t}`,children:[e.jsx(M,{modules:[pe,F],spaceBetween:0,slidesPerView:1,navigation:!0,onSlideChange:c=>{r(c.activeIndex)},className:"w-full h-full",children:s.map((c,o)=>e.jsx(I,{className:"w-full h-full",children:e.jsx("img",{src:c,alt:`${n} - ${o+1}`,className:"w-full h-full object-cover",onError:l})},o))}),s.length>1&&e.jsx("div",{className:"absolute bottom-3 left-1/2 -translate-x-1/2 bg-black/40 rounded-full px-3 py-1 z-10",children:e.jsxs("span",{className:"text-white text-xs",children:[i+1," / ",s.length]})})]})},Qe=he("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function R({className:s,variant:n,...d}){return e.jsx("div",{className:f(Qe({variant:n}),s),...d})}const is=({order:s})=>{const[n,d]=x.useState(!1),t={...s,delivery_type:s.delivery_type||"",delivery_price:s.delivery_price||"0",delivery_address:s.delivery_address||null,delivery_info:s.delivery_info||null,delivery_code:s.delivery_code||null,items:s.items.map(a=>({...a,id:typeof a.id=="number"?a.id:0,type:a.type||"stock",status:a.status||s.status||"",dewu_url:a.dewu_url||null,shipping_type:a.shipping_type||null,category_type:a.category_type||null,weight_category:a.weight_category||null,color_code:a.color_code||null,sku:a.sku||null,item_name:a.item_name||null,size:a.size||"",price_cny:a.price_cny||null,price_rub:a.price_rub||null,sale_price:a.sale_price||null,quantity:a.quantity||1}))},i=a=>{switch(a.toLowerCase()){case"delivered":case"Ð´Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½":return"bg-green-500";case"awaiting manager":case"Ð¾Ð¶Ð¸Ð´Ð°ÐµÑ‚ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð°":return"bg-yellow-500";case"awaiting purchase":case"Ð¾Ð¶Ð¸Ð´Ð°ÐµÑ‚ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸":return"bg-blue-500";case"cancelled":case"Ð¾Ñ‚Ð¼ÐµÐ½Ñ‘Ð½":return"bg-red-500";default:return"bg-gray-500"}},r=a=>{switch(a.toLowerCase()){case"delivered":return"Ð”Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½";case"awaiting manager":return"ÐžÐ¶Ð¸Ð´Ð°ÐµÑ‚ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð°";case"awaiting purchase":return"ÐžÐ¶Ð¸Ð´Ð°ÐµÑ‚ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸";case"cancelled":return"ÐžÑ‚Ð¼ÐµÐ½Ñ‘Ð½";default:return a}},l=a=>a?(typeof a=="string"?parseFloat(a):a).toLocaleString("ru-RU",{maximumFractionDigits:2}):"0",c=a=>new Date(a).toLocaleString("ru-RU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),o=a=>a%10===1&&a%100!==11?"Ñ‚Ð¾Ð²Ð°Ñ€":[2,3,4].includes(a%10)&&![12,13,14].includes(a%100)?"Ñ‚Ð¾Ð²Ð°Ñ€Ð°":"Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²";return e.jsxs("div",{className:"bg-white dark:bg-sidebar-accent rounded-lg shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-sidebar-primary/10 transition-colors",onClick:()=>d(!n),children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("h3",{className:"text-lg font-medium",children:["Ð—Ð°ÐºÐ°Ð· #",t.order_id]}),e.jsx(R,{className:`${i(t.status)} text-white`,children:r(t.status)})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:c(t.created_at)}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:[t.items.length," ",o(t.items.length)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium text-lg",children:["â‚½",l(t.final_price)]}),t.promocode&&e.jsx("p",{className:"text-sm text-telegram-blue",children:t.promocode.promocode_text}),e.jsx("button",{className:"mt-2 text-telegram-blue hover:text-telegram-dark transition-colors","aria-label":n?"Ð¡Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ Ð´ÐµÑ‚Ð°Ð»Ð¸":"Ð Ð°Ð·Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ Ð´ÐµÑ‚Ð°Ð»Ð¸",children:n?e.jsx(be,{size:20}):e.jsx(fe,{size:20})})]})]})}),n&&e.jsx("div",{className:"border-t border-gray-100 dark:border-gray-800/50",children:e.jsxs("div",{className:"p-4 space-y-4",children:[t.items.map((a,g)=>e.jsx("div",{className:"border-b dark:border-gray-700 pb-3 last:border-0",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-1",children:[e.jsx(R,{className:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300",children:a.type==="stock"?"Ð¡Ñ‚Ð¾Ðº":"ÐŸÑ€ÐµÐ´Ð·Ð°ÐºÐ°Ð·"}),a.status&&e.jsx(R,{className:`${i(a.status)} text-white`,children:r(a.status)})]}),e.jsx("p",{className:"font-medium",children:a.item_name||(a.dewu_url?e.jsxs("a",{href:a.dewu_url,target:"_blank",rel:"noopener noreferrer",className:"text-telegram-blue hover:underline flex items-center",children:[a.dewu_url.substring(0,30),a.dewu_url.length>30?"...":"",e.jsx(ye,{size:14,className:"ml-1"})]}):"Ð¢Ð¾Ð²Ð°Ñ€")}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Ð Ð°Ð·Ð¼ÐµÑ€: ",a.size," ",a.quantity>1&&`Ã— ${a.quantity}`]}),a.type==="preorder"&&a.price_cny&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Ð¦ÐµÐ½Ð° (ÑŽÐ°Ð½Ð¸): Â¥",l(a.price_cny)]}),a.sku&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["ÐÑ€Ñ‚Ð¸ÐºÑƒÐ»: ",a.sku]}),a.shipping_type&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Ð¢Ð¸Ð¿ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸: ",a.shipping_type]}),a.category_type&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ: ",a.category_type]}),a.weight_category&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Ð’ÐµÑ: ",a.weight_category]}),a.color_code&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("span",{children:"Ð¦Ð²ÐµÑ‚:"}),e.jsx("div",{className:"w-4 h-4 rounded-full border border-gray-300",style:{backgroundColor:a.color_code}})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-medium",children:["â‚½",l(a.price_rub)]})})]})},`item-${g}-${a.id}`)),e.jsxs("div",{className:"pt-3 border-t dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Ð¡ÑƒÐ¼Ð¼Ð° Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²"}),e.jsxs("span",{children:["â‚½",l(t.subtotal)]})]}),t.delivery_code&&e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:["Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐ°: ",t.delivery_code]}),e.jsx("span",{children:t.delivery_price==="0"?"Ð‘ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾":`â‚½${l(t.delivery_price)}`})]}),t.promocode&&e.jsxs("div",{className:"flex justify-between text-sm text-telegram-blue mb-1",children:[e.jsxs("span",{children:["ÐŸÑ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´: ",t.promocode.promocode_text,t.promocode.discount_percent&&t.promocode.discount_percent!=="null"&&` (-${t.promocode.discount_percent}%)`,t.promocode.discount_fixed&&` (-${t.promocode.discount_fixed}â‚½)`]}),e.jsxs("span",{children:["-â‚½",l(t.discount_amount)]})]}),t.discount_amount&&t.discount_amount!=="0"&&!t.promocode&&e.jsxs("div",{className:"flex justify-between text-sm text-telegram-blue mb-1",children:[e.jsx("span",{children:"Ð¡ÐºÐ¸Ð´ÐºÐ°"}),e.jsxs("span",{children:["-â‚½",l(t.discount_amount)]})]}),t.dd_coins_used&&t.dd_coins_used!=="0"&&e.jsxs("div",{className:"flex justify-between text-sm text-yellow-500 mb-1",children:[e.jsx("span",{children:"Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¾ DD ÐšÐ¾Ð¸Ð½Ð¾Ð²"}),e.jsxs("span",{children:["-â‚½",l(t.dd_coins_used)]})]}),t.prepay_amount&&t.prepay_amount!=="0"&&e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"ÐŸÑ€ÐµÐ´Ð¾Ð¿Ð»Ð°Ñ‚Ð°"}),e.jsxs("span",{children:["â‚½",l(t.prepay_amount)]})]}),e.jsxs("div",{className:"flex justify-between font-medium text-base mt-2",children:[e.jsx("span",{children:"Ð˜Ñ‚Ð¾Ð³Ð¾"}),e.jsxs("span",{children:["â‚½",l(t.final_price)]})]})]})]})})]})},ds=({className:s})=>{const[n,d]=x.useState(null),[t,i]=x.useState(!0),{data:r,refetch:l}=V({queryKey:["referralInfo"],queryFn:()=>Pe(),staleTime:60*1e3,retry:1,retryDelay:1e3}),{data:c,refetch:o}=V({queryKey:["referralStats"],queryFn:()=>qe(),staleTime:60*1e3,retry:1,retryDelay:1e3});x.useEffect(()=>{(async()=>{i(!0),d(null);try{await Promise.all([l(),o()])}catch(N){console.error("Error loading referral data:",N),d("Failed to load referral information")}finally{i(!1)}})()},[l,o]);const a=async()=>{if(!r){v.error("Ð ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð°");return}if(!r.telegram_deep_link){v.error("Ð ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½Ð°Ñ ÑÑÑ‹Ð»ÐºÐ° Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚"),console.error("Empty referral link:",r);return}await Re(r)},g=async()=>{if(!r){v.error("Ð ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð°");return}if(!r.telegram_deep_link){v.error("Ð ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½Ð°Ñ ÑÑÑ‹Ð»ÐºÐ° Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚"),console.error("Empty referral link:",r);return}try{await navigator.clipboard.writeText(r.telegram_deep_link),v.success("Ð ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½Ð°Ñ ÑÑÑ‹Ð»ÐºÐ° ÑÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð° Ð² Ð±ÑƒÑ„ÐµÑ€ Ð¾Ð±Ð¼ÐµÐ½Ð°")}catch(u){console.error("Error copying to clipboard:",u),v.error("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ€ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½ÑƒÑŽ ÑÑÑ‹Ð»ÐºÑƒ")}},p=()=>{i(!0),d(null),Promise.all([l(),o()]).finally(()=>i(!1))};return t?e.jsxs("div",{className:`p-4 text-center ${s}`,children:[e.jsx($,{size:"sm",className:"mx-auto"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¾ Ñ€ÐµÑ„ÐµÑ€Ð°Ð»Ð°Ñ…..."})]}):n?e.jsxs("div",{className:`p-4 text-center ${s}`,children:[e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mb-2",children:n}),e.jsxs("button",{onClick:p,className:"inline-flex items-center text-sm text-telegram-blue hover:text-telegram-dark",children:[e.jsx(je,{className:"mr-1 h-4 w-4"}),"Retry"]})]}):e.jsxs("div",{className:`space-y-2 ${s}`,children:[e.jsxs("div",{className:"p-2 bg-telegram-secondary-bg rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Ð’Ð°ÑˆÐ° Ñ€ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½Ð°Ñ ÑÑÑ‹Ð»ÐºÐ°"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",readOnly:!0,value:(r==null?void 0:r.telegram_deep_link)||"",placeholder:r!=null&&r.telegram_deep_link?"":"Ð¡ÑÑ‹Ð»ÐºÐ° Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð°",className:`flex-1 p-2 text-sm bg-white dark:bg-sidebar-primary/30 border ${r!=null&&r.telegram_deep_link?"border-gray-300 dark:border-gray-700":"border-red-300 dark:border-red-700"} rounded-md`}),e.jsx("button",{onClick:g,className:"p-2 text-telegram-blue hover:text-telegram-dark",title:"Copy link",disabled:!(r!=null&&r.telegram_deep_link),children:e.jsx(ve,{size:18})}),e.jsx("button",{onClick:a,className:"p-2 text-telegram-blue hover:text-telegram-dark",title:"Share link",children:e.jsx(Ne,{size:18})})]})]}),e.jsxs("div",{className:"p-2 bg-telegram-secondary-bg rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"ÐŸÑ€Ð¸Ð³Ð»Ð°ÑˆÐµÐ½Ð½Ñ‹Ðµ Ð´Ñ€ÑƒÐ·ÑŒÑ"}),c!=null&&c.referred_users&&c.referred_users.length>0?e.jsx("div",{className:"space-y-2",children:c.referred_users.map(u=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:u.username?`@${u.username}`:`User ${u.id}`}),e.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:["Ð¡ Ð½Ð°Ð¼Ð¸ Ñ ",new Date(u.joined_at).toLocaleDateString()]})]},u.id))}):e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Ð¢ÑƒÑ‚ Ð¿Ð¾ÐºÐ° Ð½Ð¸ÐºÐ¾Ð³Ð¾ Ð½ÐµÑ‚.."})]})]})},cs=({isOpen:s,onClose:n})=>s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-start justify-center p-3 pt-5 pb-20 overflow-y-auto bg-black bg-opacity-50 backdrop-blur-sm",children:e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg max-w-md w-full max-h-[85vh] my-4 overflow-hidden",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 flex justify-end pt-2 px-3 pb-2",children:e.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-full p-1 hover:bg-gray-100 dark:hover:bg-gray-700","aria-label":"Close",children:e.jsx(W,{size:20})})}),e.jsxs("div",{className:"p-4 pt-0 pb-6 overflow-y-auto max-h-[calc(85vh-40px)]",children:[e.jsx("h2",{className:"text-xl font-bold text-telegram-button mb-3",children:"Ðž DD Coins"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("h3",{className:"text-base font-semibold",children:"ÐšÐ°Ðº Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ $DD?"}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:"Ð’Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð¾Ð¿Ð»Ð°Ñ‡Ð¸Ð²Ð°Ñ‚ÑŒ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸ Ð² Ð½Ð°ÑˆÐµÐ¼ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¸ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ $DD!"}),e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["ÐŸÐ¾ÐºÑ€Ñ‹Ð²Ð°Ð¹Ñ‚Ðµ Ð´Ð¾ ",e.jsx("span",{className:"font-bold",children:"50%"})," Ð¾Ñ‚ Ð¾Ð±Ñ‰ÐµÐ¹ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ð·Ð°ÐºÐ°Ð·Ð°."]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 font-semibold",children:"1 $DD = 1 Ñ€ÑƒÐ±Ð»ÑŒ."})]}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-2"}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("h3",{className:"text-base font-semibold",children:"ÐšÐ°Ðº Ð·Ð°Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ $DD?"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-700 dark:text-gray-300",children:[e.jsxs("li",{children:[e.jsx("span",{className:"font-bold",children:"500 $DD"})," â€” Ð·Ð° Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ð²Ñ…Ð¾Ð´ Ð² Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-bold",children:"500 $DD"})," â€” Ð·Ð° ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ð´Ñ€ÑƒÐ³Ð°, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð·Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ð¸ ÑÐ´ÐµÐ»Ð°ÐµÑ‚ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ Ð·Ð°ÐºÐ°Ð·."]})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 italic mt-1",children:"*$DD Ð·Ð° Ð´Ñ€ÑƒÐ³Ð° Ð½Ð°Ñ‡Ð¸ÑÐ»ÑÑŽÑ‚ÑÑ Ð¿Ð¾ÑÐ»Ðµ ÐµÐ³Ð¾ Ð¿ÐµÑ€Ð²Ð¾Ð¹ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸."})]}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-2"}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("h3",{className:"text-base font-semibold",children:"Ð‘Ð¾Ð½ÑƒÑÑ‹ Ð¸ Ð¸Ð²ÐµÐ½Ñ‚Ñ‹"}),e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:["Ð¡Ð»ÐµÐ´Ð¸Ñ‚Ðµ Ð·Ð° Ð½Ð°ÑˆÐ¸Ð¼ ",e.jsx("a",{href:"https://t.me/dd_concept",target:"_blank",rel:"noopener noreferrer",className:"text-telegram-button font-bold hover:underline",children:"Telegram-ÐºÐ°Ð½Ð°Ð»Ð¾Ð¼"})," â€” ÑÐ¾Ð²ÑÐµÐ¼ ÑÐºÐ¾Ñ€Ð¾ Ñ‚Ð°Ð¼ Ð¿Ð¾ÑÐ²ÑÑ‚ÑÑ Ð¸Ð²ÐµÐ½Ñ‚Ñ‹, Ð³Ð´Ðµ Ð¼Ð¾Ð¶Ð½Ð¾ Ð±ÑƒÐ´ÐµÑ‚ Ð·Ð°Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°Ñ‚ÑŒ ÐµÑ‰Ñ‘ Ð±Ð¾Ð»ÑŒÑˆÐµ $DD Ð·Ð° ÑƒÑ‡Ð°ÑÑ‚Ð¸Ðµ Ð² Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑÑ…!"]})]})]})]})]})}):null,os=({initialEmail:s="",initialPhone:n="",initialAddress:d="",clientInfo:t=null,onComplete:i,onCancel:r,orderSubtotal:l,promocodeDiscount:c,ddCoinsDiscount:o,finalPriceAfterDDCoins:a})=>{const[g,p]=x.useState((t==null?void 0:t.email)||s),[u,N]=x.useState((t==null?void 0:t.phone_number)||n),[j,S]=x.useState((t==null?void 0:t.address)||d),[E,T]=x.useState(!1),[L,Y]=x.useState([]),[y,B]=x.useState(""),[U,H]=x.useState(!1),Z=!!(g&&u&&j);x.useEffect(()=>{const m=async()=>{H(!0);try{const h=await Ae();if(Y(h),h.length>0){const te=h.find(q=>q.delivery_type==="courier"),ae=h.find(q=>q.delivery_type==="shipping"),re=te||ae||h[0];B(re.delivery_type)}}catch(h){console.error("Failed to load delivery types:",h)}finally{H(!1)}},k=async()=>{if(!t)try{const h=await Me();h&&(p(h.email||""),N(h.phone_number||""),S(h.address||""))}catch(h){console.error("Error fetching client info:",h)}};m(),k()},[t]);const D=L.find(m=>m.delivery_type===y),b=D?{delivery_type:D.delivery_type,price_rub:D.price_rub}:void 0,w=y==="self_pickup",[P,O]=x.useState("");x.useEffect(()=>{const m=(t==null?void 0:t.address)||d;m&&O(m)},[d,t]),x.useEffect(()=>{S(w?"ÐœÐ¾ÑÐºÐ²Ð°, Ð˜Ð»ÑŒÐ¼ÐµÐ½ÑÐºÐ¸Ð¹ Ð¿Ñ€Ð¾ÐµÐ·Ð´, 14Ðº8":P)},[w,P]);const ee=m=>{const k=m.target.value;S(k),w||O(k)},se=async m=>{m.preventDefault(),T(!0);try{if(!g||!u||!y){alert("Please fill in all required fields"),T(!1);return}await Fe(u,g,w?P:j)&&i(b)}catch(k){console.error("Error updating client info:",k)}finally{T(!1)}};return e.jsx("div",{className:"fixed inset-0 flex items-start justify-center z-50 p-4 pb-20 overflow-y-auto bg-black bg-opacity-50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white dark:bg-sidebar-accent rounded-lg shadow-lg max-w-md w-full my-8",children:[e.jsxs("div",{className:"p-4 border-b dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Ð—Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ ÑÐ²Ð¾Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ðµ"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:Z?"ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ ÑÐ²Ð¾Ð¸ ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ.":"ÐÐ°Ð¼ Ð½ÑƒÐ¶Ð½Ñ‹ Ð²Ð°ÑˆÐ¸ ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð·Ð°ÐºÐ°Ð·Ð°."})]}),e.jsxs("form",{onSubmit:se,className:"p-4 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Ð­Ð»ÐµÐºÑ‚Ñ€Ð¾Ð½Ð½Ð°Ñ Ð¿Ð¾Ñ‡Ñ‚Ð° ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",value:g,onChange:m=>p(m.target.value),className:"w-full p-2 border border-gray-300 dark:border-gray-700 rounded dark:bg-sidebar-primary",placeholder:"Ð²Ð°ÑˆÐ°@Ð¿Ð¾Ñ‡Ñ‚Ð°.com",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium",children:["ÐÐ¾Ð¼ÐµÑ€ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð° ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",value:u,onChange:m=>N(m.target.value),className:"w-full p-2 border border-gray-300 dark:border-gray-700 rounded dark:bg-sidebar-primary",placeholder:"+7 (999) 123-4567",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium",children:["Ð¡Ð¿Ð¾ÑÐ¾Ð± Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ ",e.jsx("span",{className:"text-red-500",children:"*"})]}),U?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{size:"xs",inline:!0,className:"mr-2"}),e.jsx("span",{children:"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð¾Ð² Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸..."})]}):L.length===0?e.jsx("div",{className:"text-red-500",children:"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð¾Ð² Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸. ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð¿Ð¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð¿Ð¾Ð·Ð¶Ðµ."}):e.jsx("div",{className:"grid gap-2",children:L.map(m=>e.jsx("div",{className:`p-3 border rounded-lg cursor-pointer transition-colors ${y===m.delivery_type?"border-telegram-blue bg-telegram-blue/10":"border-gray-300 dark:border-gray-700"}`,onClick:()=>B(m.delivery_type),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:m.delivery_code}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:m.delivery_info})]}),e.jsx("div",{className:"text-telegram-blue font-medium",children:m.price_rub>0?`â‚½${m.price_rub}`:"Ð‘ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾"})]})},m.delivery_type))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium",children:["ÐÐ´Ñ€ÐµÑ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ ",(y==="courier"||y==="shipping")&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:j,onChange:ee,className:`w-full p-2 border rounded resize-none h-24 ${w?"bg-gray-100 dark:bg-gray-800":"bg-white dark:bg-sidebar-primary"} dark:border-gray-700`,placeholder:"Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ Ð²Ð°Ñˆ Ð¿Ð¾Ð»Ð½Ñ‹Ð¹ Ð°Ð´Ñ€ÐµÑ",disabled:w,required:y==="courier"||y==="shipping"}),w&&e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"ÐŸÑ€Ð¸ ÑÐ°Ð¼Ð¾Ð²Ñ‹Ð²Ð¾Ð·Ðµ Ð·Ð°ÐºÐ°Ð· Ð¼Ð¾Ð¶Ð½Ð¾ Ð·Ð°Ð±Ñ€Ð°Ñ‚ÑŒ Ð¿Ð¾ ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ð¾Ð¼Ñƒ Ð°Ð´Ñ€ÐµÑÑƒ"})]}),l!==void 0&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/20 border border-gray-200 dark:border-gray-700 rounded-lg p-4 mt-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Ð¡ÑƒÐ¼Ð¼Ð° Ð·Ð°ÐºÐ°Ð·Ð°"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Ð¢Ð¾Ð²Ð°Ñ€Ñ‹"}),e.jsxs("span",{children:["â‚½",l.toLocaleString()]})]}),b&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:["Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐ° (",b.delivery_type==="self_pickup"?"Ð¡Ð°Ð¼Ð¾Ð²Ñ‹Ð²Ð¾Ð·":b.delivery_type==="courier"?"ÐšÑƒÑ€ÑŒÐµÑ€":"ÐŸÐ¾Ñ‡Ñ‚Ð°",")"]}),e.jsx("span",{children:b.price_rub>0?`â‚½${b.price_rub.toLocaleString()}`:"Ð‘ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾"})]}),c&&c.amount>0&&e.jsxs("div",{className:"flex justify-between text-telegram-blue",children:[e.jsxs("span",{children:["Ð¡ÐºÐ¸Ð´ÐºÐ° (",c.text,")"]}),e.jsxs("span",{children:["-",c.type==="fixed"?`â‚½${c.amount}`:`${c.amount}%`]})]}),o&&o>0&&e.jsxs("div",{className:"flex justify-between text-yellow-600 dark:text-yellow-400",children:[e.jsx("span",{children:"DD ÐšÐ¾Ð¸Ð½Ñ‹"}),e.jsxs("span",{children:["-â‚½",o]})]}),e.jsxs("div",{className:"flex justify-between font-medium text-base pt-2 border-t border-gray-200 dark:border-gray-600",children:[e.jsx("span",{children:"Ð˜Ñ‚Ð¾Ð³Ð¾ Ðº Ð¾Ð¿Ð»Ð°Ñ‚Ðµ"}),e.jsxs("span",{children:["â‚½",a!==void 0?(a+((b==null?void 0:b.price_rub)||0)).toLocaleString():Math.max(0,l+((b==null?void 0:b.price_rub)||0)-((c==null?void 0:c.type)==="fixed"?c.amount:0)-(o||0)).toLocaleString()]})]})]})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3 mt-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"text-blue-600 dark:text-blue-400 mt-0.5",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"text-blue-800 dark:text-blue-200 font-medium",children:"ÐŸÐµÑ€ÐµÐ´ Ð¾Ð¿Ð»Ð°Ñ‚Ð¾Ð¹ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð·Ð°ÐºÐ°Ð·"}),e.jsxs("p",{className:"text-blue-700 dark:text-blue-300 mt-1",children:["ÐÐµ Ð¿ÐµÑ€ÐµÐ¶Ð¸Ð²Ð°Ð¹Ñ‚Ðµ, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾ Ð·Ð°Ð½Ð¸Ð¼Ð°ÐµÑ‚ Ð½Ðµ Ð±Ð¾Ð»ÐµÐµ 30 Ð¼Ð¸Ð½ÑƒÑ‚. ÐŸÐ¾ÑÐ»Ðµ ÑÑ‚Ð¾Ð³Ð¾ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€ ÑÐ°Ð¼ ÑÐ²ÑÐ¶ÐµÑ‚ÑÑ Ñ Ð²Ð°Ð¼Ð¸ Ð¸ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ Ð½Ð° Ð¾Ð¿Ð»Ð°Ñ‚Ñƒ. Ð•ÑÐ»Ð¸ Ð²Ð´Ñ€ÑƒÐ³ Ð²Ð¾Ð·Ð½Ð¸ÐºÐ½ÑƒÑ‚ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹ â€” Ð²Ñ‹ Ð²ÑÐµÐ³Ð´Ð° Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð½Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ð½Ð°Ð¼ Ð¿ÐµÑ€Ð²Ñ‹Ð¼Ð¸! ÐÐ°Ñˆ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€:"," ",e.jsx("a",{href:"https://t.me/dd_helper",target:"_blank",rel:"noopener noreferrer",className:"font-medium hover:underline",children:"@dd_helper"})]})]})]})}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4 border-t dark:border-gray-700",children:[r&&e.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md",disabled:E,children:"ÐžÑ‚Ð¼ÐµÐ½Ð°"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium bg-telegram-blue text-white rounded-md hover:bg-blue-600 disabled:opacity-50",disabled:E||!g||!u||U||!y||(y==="courier"||y==="shipping")&&!j,children:E?e.jsxs(e.Fragment,{children:[e.jsx($,{size:"xs",inline:!0,className:"mr-2"}),"Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ..."]}):"ÐžÑ„Ð¾Ñ€Ð¼Ð¸Ñ‚ÑŒ Ð·Ð°ÐºÐ°Ð·"})]})]})]})})},xs=({item:s,onRemove:n})=>{const{updateQuantity:d}=G(),t=()=>{z(),d(s.productId,s.size,s.quantity+1)},i=()=>{z(),s.quantity>1?d(s.productId,s.size,s.quantity-1):n()},r=()=>{if(s.item_type==="preorder")return s.category_type==="Ð¾Ð±ÑƒÐ²ÑŒ"?"ðŸ‘Ÿ":s.category_type==="Ð¾Ð´ÐµÐ¶Ð´Ð°"?"ðŸ‘•":s.category_type==="Ð°ÐºÑÐµÑÑÑƒÐ°Ñ€Ñ‹"?"ðŸ‘œ":"ðŸ”®"};return e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-white dark:bg-sidebar-accent rounded-lg shadow-sm",children:[e.jsx("div",{className:"flex-shrink-0 w-20 h-20 bg-gray-100 dark:bg-gray-800 rounded-md flex items-center justify-center text-4xl overflow-hidden",children:s.photo_url?e.jsx("img",{src:s.photo_url,alt:s.name,className:"w-full h-full object-cover",onError:l=>{l.currentTarget.style.display="none",l.currentTarget.parentElement.innerHTML=r()}}):r()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:s.name}),e.jsx("button",{onClick:n,className:"text-red-500 hover:text-red-700","aria-label":"Remove item",children:e.jsx(we,{size:16})})]}),s.item_type==="preorder"?e.jsxs("div",{className:"mt-1 text-xs text-gray-600 dark:text-gray-400",children:[e.jsxs("p",{className:"truncate",children:["URL: ",s.dewu_url]}),e.jsxs("p",{children:["Ð Ð°Ð·Ð¼ÐµÑ€: ",s.size||"ÐÐµ ÑƒÐºÐ°Ð·Ð°Ð½"]}),e.jsxs("p",{children:["ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ: ",s.category_type==="Ð¾Ð±ÑƒÐ²ÑŒ"?"ÐžÐ±ÑƒÐ²ÑŒ":s.category_type==="Ð¾Ð´ÐµÐ¶Ð´Ð°"?"ÐžÐ´ÐµÐ¶Ð´Ð°":s.category_type==="Ð°ÐºÑÐµÑÑÑƒÐ°Ñ€Ñ‹"?"ÐÐºÑÐµÑÑÑƒÐ°Ñ€Ñ‹":s.category_type]}),e.jsxs("p",{children:["Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐ°: ",(s.shipping_type||s.delivery_type)==="cargo"?"ÐÐ²Ñ‚Ð¾Ð¼Ð¾Ð±Ð¸Ð»ÑŒ":"Ð¡Ð°Ð¼Ð¾Ð»ÐµÑ‚"]})]}):e.jsxs("div",{className:"mt-1 text-xs text-gray-600 dark:text-gray-400",children:[e.jsx("p",{children:s.color&&`Ð¦Ð²ÐµÑ‚: ${s.color}`}),e.jsxs("p",{children:["Ð Ð°Ð·Ð¼ÐµÑ€: ",s.size]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("div",{className:"text-sm font-medium text-telegram-blue",children:["â‚½",(s.sale_price||s.price).toLocaleString()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:i,className:"p-1 rounded-full bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700","aria-label":"Decrease quantity",children:e.jsx(ke,{size:14})}),e.jsx("span",{className:"text-sm font-medium w-6 text-center",children:s.quantity}),e.jsx("button",{onClick:t,className:"p-1 rounded-full bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700","aria-label":"Increase quantity",children:e.jsx(_e,{size:14})})]})]})]})]})},ms=({className:s,originalPrice:n,onPromocodeApplied:d,onPromocodeRemoved:t,currentPromocode:i})=>{const[r,l]=x.useState("");x.useState(!1);const[c,o]=x.useState(!1),a=async g=>{if(g.preventDefault(),!r.trim()){v.error("ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð²Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¿Ñ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´");return}o(!0);try{const p=await Ie(r.trim());if(p.success&&p.promocode){const u=Be(n,p.promocode);d(p.promocode,u),v.success("ÐŸÑ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½!")}else v.error(p.message||"ÐÐµÐ´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´")}catch(p){console.error("Error validating promocode:",p),v.error("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´")}finally{o(!1)}};return i?e.jsxs("div",{className:`flex items-center justify-between p-3 bg-telegram-secondary-bg rounded-lg ${s}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"text-telegram-blue",size:16}),e.jsx("span",{className:"text-sm font-medium",children:i.promocode_text})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:i.discount_fixed?`-${i.discount_fixed}â‚½`:i.discount_percent&&i.discount_percent!=="null"?`-${i.discount_percent}%`:""}),e.jsx("button",{onClick:t,className:"text-sm text-red-500 hover:text-red-600",children:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ"})]})]}):e.jsxs("form",{onSubmit:a,className:`flex gap-2 ${s}`,children:[e.jsx("input",{type:"text",value:r,onChange:g=>l(g.target.value),placeholder:"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¿Ñ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´",className:"flex-1 p-2 text-sm bg-white dark:bg-sidebar-primary/30 border border-gray-300 dark:border-gray-700 rounded-md",disabled:c}),e.jsx("button",{type:"submit",disabled:c||!r.trim(),className:"px-4 py-2 bg-telegram-blue text-white rounded-md disabled:opacity-70 flex items-center",children:c?e.jsxs(e.Fragment,{children:[e.jsx($,{size:"xs",inline:!0,className:"mr-2"}),"ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ°..."]}):"ÐŸÑ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ"})]})},us=()=>{const{pathname:s}=K();return x.useEffect(()=>{const n=Ue();return console.log(`ScrollToTop component executed for path: ${s}`),n},[s]),null};export{es as B,xs as C,ss as D,as as I,$ as L,is as O,Ye as P,ds as R,ts as S,Xe as T,Ze as U,rs as a,ns as b,ls as c,cs as d,ms as e,os as f,us as g};
//# sourceMappingURL=components-BW_9l5st.js.map
